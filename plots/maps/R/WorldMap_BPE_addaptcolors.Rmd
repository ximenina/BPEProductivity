---
title: "World Maps: BPE Compression"
author: 'Chris Bentz'
date: "February 03, 2022"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Session Info
Give the session info (reduced).
```{r, echo = F}
# R version
sessionInfo()$R.version$version.string
# platform
sessionInfo()$R.version$platform 
```

# Load Libraries
If the libraries are not installed yet, you need to install them using, for example, the command: install.packages("ggplot2").
```{r, message = FALSE}
library(readr)
library(ggmap)
library(maps)
library(gridExtra)
library(ggrepel)
library(RCurl)
library(mapproj)
```

Give the package versions.
```{r, echo = F}
# version of packages loaded
installed.packages()[names(sessionInfo()$otherPkgs), "Version"]
```

# Load the language info 
Load language info.
```{r, message = F}
wals.info <- as.data.frame(read_csv("extended_WALSinfo.csv"))
partitions <- as.data.frame(read_csv("partitions_colors.csv"))
languages <- merge(wals.info, partitions, by.x = "ISO639P3code", by.y = "iso639_3")
head(languages)
```
# Simple Statistics

## Simple Stats
```{r}
length(unique(languages$ISO639P3code)) # number of languages according to iso
length(unique(languages$Glottocode)) # number of languages according to glottolog
length(unique(languages$family)) # number of language families according to wals
length(unique(languages$Family)) # number of language families according to glottolog
unique(languages$Macroarea) # number of macroareas according to glottolog 
```
## Pre-Processing
```{r}
# add 360 to longitudes for languages with longitudes < -25 
# (this is necessary to create a Pacific centered map)
languages$Longitude[languages$Longitude < -25] <- 
  languages$Longitude[languages$Longitude < -25] + 360
```

## World Map 
World maps with endangerment status information from Glottolog.
```{r, fig.width = 10, fig.height = 5, warning = FALSE}
# create world map
world <- map_data("world", wrap = c(-25, 335)) #
partition.map <- ggplot() + 
  coord_map("rectangular", lat0 = 0) +
  geom_polygon(data = world, aes(x = long, y = lat, group = group), 
               fill = "white", colour = "darkgrey") +
  geom_point(data = languages, aes(x = Longitude, y = Latitude, 
                                 fill = as.factor(partition)), 
             alpha = 1, size = 3.5, pch = 21) +
             # select colours manually 
             #scale_fill_manual(values = c("#E69F00", "#661100", "#009E73", "#F0E442")) +
  geom_text_repel(data = languages, aes(x = Longitude, y = Latitude, 
                                        label = language), size = 2.5,
                  box.padding = unit(0.1, 'lines'), force = 0.5) +
  scale_y_continuous(limits = c(-60, 80)) +
  labs(x = "longitude", y = "latitude", fill = "Partition") +
  theme_bw() +
  theme(axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        title = element_text(size = 12),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 12),
        legend.position = "bottom")
partition.map
```

Save to file.
```{r, warning = FALSE}
ggsave("~/Desktop/WorldMap_BPE/worldMapBPE.pdf", partition.map, dpi = 300, scale = 1, width = 12, height = 6, device = cairo_pdf)
```
